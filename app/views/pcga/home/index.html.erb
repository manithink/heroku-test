  <div class="breadcrum">
    <ul>
      <li><%= link_to "Home", pcga_home_index_path%></li>
      <li class="greater-than"><%= image_tag "greater-than.png", :width => "4", :height => "7"%></li>
      <li><%= change_name("pcg")%></li>
    </ul>
  </div>
  <h3 class="clear relative m_btm-15"><%= change_name("Care Giver")%>s (<%= change_name("pcg")%>)
    <%= link_to "Assign Care Clients", pcga_assign_care_clients_new_path, class: "farCare-btn assign-clients"%>
    <%= link_to "Add #{change_name("pcg")}",  new_pcg_home_path, class: "add-pcgc farCare-btn"%>
  </h3>
  <div class="row">
    <div class="search relative">
      <%= form_tag pcga_home_index_path, :method => 'get' do %>
      <%= hidden_field_tag :direction, params[:direction] %>
      <%= hidden_field_tag :sort, params[:sort] %>
      <p>
        <%= text_field_tag :search, params[:search], placeholder: "Search" %>
        <%= submit_tag "", :name => nil, :class => "search-icon"%>
      </p>
      <% end %>
    </div>
  </div>
  <div class="row">
    <table width="100%" cellspacing="0" cellpadding="0" class="farCare-tble sort-table">
      <tr>
      <% unless @care_givers.empty?  %>
        <th width="32%"><%= sortable "first_name" %></th>
        <th width="32%"><%= sortable "last_name" %></th>
        <th width="11%"><%= sortable "clients" %> </th>
        <th width="11%">Calendar</th>
        <th width="10%"><%= sortable "status" %></th>
        <th width="4%">&nbsp;</th>
      <% else %>
        <th width="32%">First Name</th>
        <th width="32%">Last Name</th>
        <th width="11%">Clients</th>
        <th width="11%">Calendar</th>
        <th width="10%">Status</th>
        <th width="4%">&nbsp;</th>
      <% end %>
      </tr>
      <% unless @care_givers.empty?  %>
        <% @care_givers.each do |care_giver| %>
        <tr>
          <td><%= link_to care_giver.first_name, edit_pcg_home_path(care_giver.id) %></td>
          <td><%= link_to care_giver.last_name, edit_pcg_home_path(care_giver.id) %></td>
          <td><a href="" class=<%= care_giver.care_clients.count.eql?(0) ? "" : "care_cliet_popup" %> id="farCare-popup-<%= care_giver.id %>"><%= care_giver.care_clients.count %></a></td>
          <td class=<%= care_giver.current_work_status %>><a href="<%=  calendar_care_giver_path(care_giver) %>" class="calender active"><%= image_tag "calender.png", :width =>"16", :height => "16"%></a></td>
          <td class="status_change"><%= status_pcg(care_giver.status, care_giver.id, params[:page])%></td>
          <td class="last-td"><%= link_to "", pcg_delete_care_giver_path(care_giver.id), class: "delete", :id => "pcg_delete_link"%></td>
        </tr>
        <% end %>
      <% else %>
        <tr><td colspan="10" class="last-td">No Records Found</td><tr>
      <% end %>
      </table>
    </div>
    <% unless @care_givers.empty? %>
    <div class="row">
      <%= paginate @care_givers, :outer_window => 1 %>
    </div>
    <% end %>


    <% unless @care_givers.empty? %>
        <% @care_givers.each do |care_giver| %>
        <% cc = care_giver.care_clients %>
    <!-- popup start-->
          <div id="care-clients" class="farCare-popup farCare-popup-<%= care_giver.id %>">
        <a href="" class="close"></a>
        <h4 class="m_btm-0">Associated Care Clients of <%= care_giver.first_name %> </h4>
          <div class="row">
          <div id="mcs_container<%= care_giver.id%>" class="lists">
          <% scroll_style = cc.length < 5 ? "height:auto" : "" %>
          <div class="customScrollBox" style=<%= scroll_style %>>
            <div class="container">
            <div class="content">
            <ul class="client-lists">
             <% unless cc.empty? %>
                <% cc.each do |care_client|%>
                  <li><%= link_to get_full_name(care_client), edit_fcg_home_path(care_client.id)%></li>
                <% end %>
              <% end %>
            </ul>
            </div>
            </div>
            <div class="dragger_container">
                <div class="dragger"></div>
              </div>
            </div>
            </div>
          </div>
      </div>



  <% end %>
  <% end %>

  <div id="backgroundPopup"></div>

  <script type="text/javascript">
  function mCustomScrollbars(id){
    var id_string = "#mcs_container"+id;
  $(id_string).mCustomScrollbar("vertical",300,"easeOutCirc",1.05,"auto","yes","yes",15);  
}
$(function() {
  var timer;

$(".care_cliet_popup").mouseenter(function(){
   self = $(this);
   timer = setTimeout(function(){
      loadPopup(self)
   },1000)
}).mouseleave(function(){
   clearTimeout(timer);
});


  $(".close").click(function() {
    disablePopup();  // function close pop up
  });

  $(this).keyup(function(event) {
    if (event.which == 27) { // 27 is 'Ecs' in the keyboard
      disablePopup();  // function close pop up
    }
  });

  $("div#backgroundPopup").click(function() {
    disablePopup();  // function close pop up
  });

  function loading() {
    $("div.loader").show();
  }

  function closeloading() {
    $("div.loader").fadeOut('normal');
  }

  var popupStatus = 0; // set value

  function loadPopup(self) {
    var id_name = self.attr('id');
    if(popupStatus == 0) { // if value is 0, show popup
      closeloading(); // fadeout loading
      $("div."+id_name).fadeIn(500); // fadein popup div
      $("#backgroundPopup").css("opacity", "0.7"); // css opacity, supports IE7, IE8
      $("#backgroundPopup").fadeIn(0001);
      popupStatus = 1; // and set value to 1
      var id = id_name.match(/\d+$/);
      mCustomScrollbars(id);
    }
  }
  function disablePopup() {
    if(popupStatus == 1) { // if value is 1, close popup
      $("#care-clients").fadeOut("normal");
      $(".farCare-popup").fadeOut("normal");
      $("#backgroundPopup").fadeOut("normal");
      popupStatus = 0;  // and set value to 0
    }
  }
});

</script>

